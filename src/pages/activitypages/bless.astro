---
import Layout from '~/layouts/Layout.astro';
import SerenaActivity from '~/components/activitystyles/activity.astro';
import '~/styles/feature-text.css';

const metadata = {
  title: 'Activity — SERENA',
  description: 'Write down your question',
};
---

<Layout metadata={metadata}>

<!-- 鼠标控制 -->
<div class="relative bg-white flex flex-col text-white font-serena cursor-none">
  <div 
    id="custom-cursor" 
    class="pointer-events-none fixed top-0 left-0 w-3 h-3 bg-white rounded-full mix-blend-exclusion"
    style="z-index: 9999; will-change: transform; transition: opacity 0.15s ease;"
  ></div>

  <script>
    const cursor = document.getElementById('custom-cursor');
    
    if (cursor) {
      let mouseX = -100;
      let mouseY = -100;
      let isVisible = false;

      // 初始隐藏
      cursor.style.opacity = '0';

      const updateCursor = (e: MouseEvent) => {
        mouseX = e.clientX;
        mouseY = e.clientY;

        // 首次移动时显示
        if (!isVisible) {
          isVisible = true;
          // @ts-ignore
          cursor.style.opacity = '1';
        }
      }

      const animate = () => {
        // @ts-ignore
        if (isVisible && cursor) {
          cursor.style.transform = `translate3d(${mouseX}px, ${mouseY}px, 0) translate(-50%, -50%)`;
        }
        requestAnimationFrame(animate);
      };

      window.addEventListener('mousemove', updateCursor, { passive: true });
      
      // 页面可见性处理
      document.addEventListener('mouseleave', () => {
        isVisible = false;
        cursor.style.opacity = '0';
      });

      window.addEventListener('pageshow', () => {
        document.documentElement.style.cursor = 'none';
      });

      animate();
    }
  </script>

<SerenaActivity />
  </div>
</Layout>
